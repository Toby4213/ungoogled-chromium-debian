description: disable flags that are introduced after clang 7
author: Michael Gilbert <mgilbert@debian.org>

--- a/base/BUILD.gn
+++ b/base/BUILD.gn
@@ -135,7 +135,7 @@
 }
 
 config("memory_tagging") {
-  if (current_cpu == "arm64" &&
+  if (false &&
       (is_linux || is_chromeos || is_android || is_fuchsia)) {
     # base/ has access to the MTE intrinsics because it needs to use them,
     # but they're not backwards compatible. Use base::CPU::has_mte()
--- a/build/config/compiler/BUILD.gn
+++ b/build/config/compiler/BUILD.gn
@@ -132,7 +132,7 @@
   #
   # TODO(crbug.com/977230): Enabling this when 'use_xcode_clang' is true may
   # call an old clang that doesn't support auto-init.
-  init_stack_vars = !is_android && !use_xcode_clang
+  init_stack_vars = false
 
   # This argument is to control whether enabling text section splitting in the
   # final binary. When enabled, the separated text sections with prefix
@@ -717,7 +717,7 @@
   # present. On Android this increases binary size due to more thinks for long
   # jumps. Turn it off by default and enable selectively for targets where it's
   # beneficial.
-  if (use_lld && !enable_call_graph_profile_sort) {
+  if (false) {
     if (is_win) {
       ldflags += [ "/call-graph-profile-sort:no" ]
     } else if (!is_apple) {
@@ -1585,29 +1585,9 @@
         # Flags NaCl (Clang 3.7) and Xcode 9.2 (Clang clang-900.0.39.2) do not
         # recognize.
         cflags += [
-          # An ABI compat warning we don't care about, https://crbug.com/1102157
-          # TODO(thakis): Push this to the (few) targets that need it,
-          # instead of having a global flag.
-          "-Wno-psabi",
-
           # Ignore warnings about MSVC optimization pragmas.
           # TODO(thakis): Only for no_chromium_code? http://crbug.com/912662
           "-Wno-ignored-pragma-optimize",
-
-          # TODO(https://crbug.com/989932): Evaluate and possibly enable.
-          "-Wno-implicit-int-float-conversion",
-
-          # TODO(https://crbug.com/999886): Clean up, enable.
-          "-Wno-final-dtor-non-final-class",
-
-          # TODO(https://crbug.com/1016945) Clean up, enable.
-          "-Wno-builtin-assume-aligned-alignment",
-
-          # TODO(https://crbug.com/1028110): Evaluate and possible enable.
-          "-Wno-deprecated-copy",
-
-          # TODO(https://crbug.com/1050281): Clean up, enable.
-          "-Wno-non-c-typedef-for-linkage",
         ]
 
         cflags_c += [
@@ -1615,12 +1595,6 @@
           "-Wno-implicit-fallthrough",
         ]
 
-        if (enable_wmax_tokens) {
-          cflags += [ "-Wmax-tokens" ]
-        } else {
-          # TODO(https://crbug.com/1049569): Remove after Clang 87b235db.
-          cflags += [ "-Wno-max-tokens" ]
-        }
       }
     }
   }
@@ -1751,7 +1725,7 @@
       # suppressing them individually, we just blanket suppress them here.
       "-Wno-unused-variable",
     ]
-    if (!is_nacl && (current_toolchain == host_toolchain || !use_xcode_clang)) {
+    if (false) {
       cflags += [
         # TODO(https://crbug.com/1031169): Clean up and enable.
         "-Wno-misleading-indentation",
--- a/third_party/angle/BUILD.gn
+++ b/third_party/angle/BUILD.gn
@@ -178,7 +178,6 @@
     cflags += [
       "-Wbad-function-cast",
       "-Wconditional-uninitialized",
-      "-Wextra-semi-stmt",
       "-Wfloat-conversion",
       "-Winconsistent-missing-destructor-override",
       "-Wmissing-field-initializers",
@@ -200,14 +199,6 @@
       "-Wunreachable-code",
       "-Wshorten-64-to-32",
     ]
-    if (!use_xcode_clang) {
-      # Mac catalyst uses a clang version that doesn't have these.
-      cflags += [
-        "-Wdeprecated-copy",
-        "-Wsuggest-destructor-override",
-        "-Wsuggest-override",
-      ]
-    }
   }
 
   if (angle_is_winuwp) {
--- a/third_party/angle/src/compiler/preprocessor/preprocessor.l
+++ b/third_party/angle/src/compiler/preprocessor/preprocessor.l
@@ -50,7 +50,6 @@
 #pragma clang diagnostic ignored "-Wunknown-warning-option"
 #endif
 // Flex isn't semi-colon clean.
-#pragma clang diagnostic ignored "-Wextra-semi-stmt"
 #pragma clang diagnostic ignored "-Wunreachable-code"
 #endif
 
--- a/third_party/angle/src/compiler/preprocessor/preprocessor_lex_autogen.cpp
+++ b/third_party/angle/src/compiler/preprocessor/preprocessor_lex_autogen.cpp
@@ -708,7 +708,6 @@
 #        pragma clang diagnostic ignored "-Wunknown-warning-option"
 #    endif
 // Flex isn't semi-colon clean.
-#    pragma clang diagnostic ignored "-Wextra-semi-stmt"
 #    pragma clang diagnostic ignored "-Wunreachable-code"
 #endif
 
--- a/third_party/angle/src/compiler/translator/glslang.l
+++ b/third_party/angle/src/compiler/translator/glslang.l
@@ -46,7 +46,6 @@
 #pragma clang diagnostic ignored "-Wunknown-warning-option"
 #endif
 // Flex isn't semi-colon clean.
-#pragma clang diagnostic ignored "-Wextra-semi-stmt"
 #pragma clang diagnostic ignored "-Wunreachable-code"
 #endif
 }
--- a/third_party/angle/src/compiler/translator/glslang_lex_autogen.cpp
+++ b/third_party/angle/src/compiler/translator/glslang_lex_autogen.cpp
@@ -31,7 +31,6 @@
 #        pragma clang diagnostic ignored "-Wunknown-warning-option"
 #    endif
 // Flex isn't semi-colon clean.
-#    pragma clang diagnostic ignored "-Wextra-semi-stmt"
 #    pragma clang diagnostic ignored "-Wunreachable-code"
 #endif
 
--- a/third_party/blink/renderer/BUILD.gn
+++ b/third_party/blink/renderer/BUILD.gn
@@ -46,14 +46,7 @@
       "-Wconversion",
       "-Wno-float-conversion",
       "-Wno-sign-conversion",
-      "-Wno-implicit-float-conversion",
-      "-Wno-implicit-int-conversion",
     ]
-
-    if (!is_chromeos_ash ||
-        default_toolchain != "//build/toolchain/cros:target") {
-      cflags += [ "-Wno-enum-float-conversion" ]
-    }
   }
 }
 
